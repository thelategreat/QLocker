<html>
<script type="text/javascript"
  src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>

<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style>
div.var_tab{
border-style: solid;
border-width: 1px;
border-color: black;
padding:0px 5px 0px 5px;
height:25px;

}



</style>


<script>

var_dict={};

function renderVariables(){
    container = document.getElementById('var_tabs');
    container.innerHTML = '';
    for (var_name in var_dict){
        //alert(var_name);
        container.innerHTML += "<div id = '"+var_name+"_tab' class='var_tab'>"+var_name+"</div>";
    }
    //alert(container.innerHTML);
}



function translateEquation(){
inputString = document.getElementById("input_text").value;
$.ajax({
  url: "/qlocker/convert?e="+encodeURIComponent(inputString),
  context: document.body,
  success: function(data){
   document.getElementById("equation").innerHTML = data;
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,"equation"]);
  }
});


}

</script>


<body>

<br>
<div>
<div id="story" style='min-height:100px;width:70%;float:left;'>Enter Word Problem<br>
    <textarea id = 'story_text'></textarea>
</div>
<div id = 'var_cont' style='min-height:100px;width:20%;float:right;'>
Variables<br>
    <div id='var_tabs'></div>
    <div id = 'var_props'></div>
</div>
<div id="input" style='min-height:100px;width:70%;float:left;'>Enter Equation<br>
    <textarea id = 'input_text'></textarea>
</div>
<div id="equation_preview" style='min-height:100px;width:70%;float:left;'>
    <div id="equation"></div>
</div>
<div style = 'clear:both'>
    <input type='button'  value = 'preview' onclick='javascript:translateEquation()'/>
</div>
</div>
</body>
<script>
$("#story_text").on('keyup' , function(event){
    var var_list = new Array();
    test=$('textarea#story_text').val();
    //alert(test);
    vars = test.split("<");
    if (vars.length > 1 && test.split(">").length == vars.length ){
        //alert(vars)
        var_list= new Array();
        //alert(var_list);
        for (i = 1; i< vars.length; i++){
        //alert(vars[i]);
            var_list = var_list.concat([vars[i].split(">")[0]]);
            //alert(var_list);
        }
        //alert(var_list.length);
        //document.getElementById('var_cont').innerHTML = '';
        for (j=0; j < var_list.length; j++){
            //document.getElementById('var_cont').innerHTML += " "+var_list[j]; 
            if (!(var_list[j] in var_dict)){
                var_dict[var_list[j]] = {'name':var_list[j]};
                //alert(var_list[j]);
            }
        }
    renderVariables();
    }
});
</script>

</html>